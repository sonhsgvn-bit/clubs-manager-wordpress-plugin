/**
 * Simple Lightbox JavaScript for Club Gallery
 */

(function($) {
    'use strict';

    var ClubsLightbox = {
        images: [],
        currentIndex: 0,
        $overlay: null,

        init: function() {
            this.createOverlay();
            this.bindEvents();
        },

        createOverlay: function() {
            var html = '<div class="lightbox-overlay">' +
                      '<div class="lightbox-content">' +
                      '<button class="lightbox-close">&times;</button>' +
                      '<button class="lightbox-nav lightbox-prev">&lt;</button>' +
                      '<button class="lightbox-nav lightbox-next">&gt;</button>' +
                      '<img class="lightbox-image" src="" alt="">' +
                      '<div class="lightbox-counter"></div>' +
                      '</div>' +
                      '</div>';
            
            this.$overlay = $(html).appendTo('body');
        },

        bindEvents: function() {
            var self = this;

            // Gallery links
            $(document).on('click', '.gallery-link', function(e) {
                e.preventDefault();
                var $gallery = $(this).closest('.gallery-grid');
                self.openGallery($gallery, $(this));
            });

            // Close lightbox
            this.$overlay.on('click', '.lightbox-close, .lightbox-overlay', function(e) {
                if (e.target === this) {
                    self.closeLightbox();
                }
            });

            // Navigation
            this.$overlay.on('click', '.lightbox-prev', function() {
                self.showPrevious();
            });

            this.$overlay.on('click', '.lightbox-next', function() {
                self.showNext();
            });

            // Keyboard navigation
            $(document).on('keydown', function(e) {
                if (self.$overlay.is(':visible')) {
                    switch(e.keyCode) {
                        case 27: // Escape
                            self.closeLightbox();
                            break;
                        case 37: // Left arrow
                            self.showPrevious();
                            break;
                        case 39: // Right arrow
                            self.showNext();
                            break;
                    }
                }
            });
        },

        openGallery: function($gallery, $clickedLink) {
            this.images = [];
            var self = this;

            $gallery.find('.gallery-link').each(function(index) {
                var $link = $(this);
                self.images.push({
                    src: $link.attr('href'),
                    alt: $link.find('img').attr('alt') || ''
                });

                if ($link.is($clickedLink)) {
                    self.currentIndex = index;
                }
            });

            this.showImage();
            this.$overlay.fadeIn(300);
        },

        showImage: function() {
            var image = this.images[this.currentIndex];
            this.$overlay.find('.lightbox-image').attr('src', image.src).attr('alt', image.alt);
            this.updateCounter();
            this.updateNavigation();
        },

        updateCounter: function() {
            var counter = (this.currentIndex + 1) + ' / ' + this.images.length;
            this.$overlay.find('.lightbox-counter').text(counter);
        },

        updateNavigation: function() {
            this.$overlay.find('.lightbox-prev').toggle(this.currentIndex > 0);
            this.$overlay.find('.lightbox-next').toggle(this.currentIndex < this.images.length - 1);
        },

        showPrevious: function() {
            if (this.currentIndex > 0) {
                this.currentIndex--;
                this.showImage();
            }
        },

        showNext: function() {
            if (this.currentIndex < this.images.length - 1) {
                this.currentIndex++;
                this.showImage();
            }
        },

        closeLightbox: function() {
            this.$overlay.fadeOut(300);
        }
    };

    // Initialize when document is ready
    $(document).ready(function() {
        ClubsLightbox.init();
    });

})(jQuery);